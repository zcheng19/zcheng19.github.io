---
layout:     post
title:      LTE无线网络中的时频资源
subtitle:   TDD和FDD模式下的时间和频率结构
date:       2022-07-02
author:     zcheng19
header-img: img/post-bg-rwd.jpg
catalog: true
tags:
    - Cellular Networks
---

## 概述

LTE无线网络的时隙和频率资源是LTE空中接口(空口)上需要调度的资源。时频结构等同于一个二维网格，横坐标是时间，纵坐标是频率，单位时间和单位频率的交叉点构成了一个资源颗粒RE，多个资源颗粒拼成一个资源块RB。在LTE系统中，单位时长对应一个OFDM符号的长度，单位频率对应子载波。LTE系统中需要处理的各种信号(物理层产生)和信息(物理层、链路层、网络层、应用层产生)需要分别占据不同的时频网格位置，其中，信号包括参考信号(导频信号)和同步信号(终端与基站同步)，信息包括控制信息(系统配置、数据格式、业务调度等底层和上层信令)和业务信息(用户的业务数据)。

在LTE的全双工方式中，TDD和FDD两种模式所分配的无线资源(时频网格)可用位置在时间上有明显差别，需要分开讨论。FDD模式下，通信设备同时使用两个频点工作，一个频点用于发射，另一个频点用于接收；TDD模式下，通信设备使用同一个频点进行接收和发送，在不同的时间片上区分上下行链路。以下具体介绍FDD和TDD的时频结构。

## FDD的时间结构

FDD无线帧的时间结构分为三个层次，分别是无线帧(radio frame)、子帧(subframe)和时隙(slot)。其中，无线帧是LTE时间结构中最大的单位，时长为10ms，无线帧的下一级时间单位是子帧，每个子帧时长为1ms，即10个子帧组成一个无线帧。LTE中与业务相关的资源调度以子帧为单位，即一个子帧等于一个传输间隔TTI(Transport Time Interval)，FDD模式下每个子帧都可以同时传输上行和下行的信息。时隙是LTE时间结构的基本单位，每个时隙时长0.5ms，2个时隙组成一个子帧。LTE系统的同步信号、参考信号、控制信道、加扰过程都与时隙相关。FDD帧结构如下图所示。

![](https://p69.f3.n0.cdn.getcloudapp.com/items/6quzEpoB/f4b8d8c0-3b68-432d-9888-291a37a51455.png?v=383bac1781f61bac6f6f305fdc325264)

OFDM符号是最小的时间单位，LTE系统中一个时隙包含7个OFDM符号(常规CP)，相邻子载波间隔等于一个基波的周期15kHz，所以N个子载波的频率带宽等于$15\times N$ kHz。

## TDD的时间结构

TDD时间结构中，无线帧10ms，半帧5ms，子帧1ms(一个半帧包含5个子帧)，时隙0.5ms。引入半帧的目的是与TD-SCDMA系统兼容。在LTE规范TS36.211中定义了7种TDD子帧上下行配置组合，如下表所示，D代表下行子帧，U代表上行子帧，S代表特殊子帧。在实际的TD-LTE网络中，目前只采用了配置1和配置2，称为2:2和1:3配置，代表一个半帧中上行子帧和下行子帧的数量。

|配置方式|0|1|2|3|4|5|6|7|8|9|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|0|D|S|U|U|U|D|S|U|U|U|
|1 (2:2)|D|S|U|U|D|D|S|U|U|D|
|2 (1:3)|D|S|U|D|D|D|S|U|D|D|
|3|D|S|U|U|U|D|D|D|D|D|
|4|D|S|U|U|D|D|D|D|D|D|
|5|D|S|U|D|D|D|D|D|D|D|
|6|D|S|U|U|U|D|S|U|U|D|

也就是说TDD模式下，一般每个子帧只能有一种配置，要么上行，要么下行；特殊子帧虽然可以在一个子帧中既有上行也有下行，但也是分时隙的，以OFDM符号长度为单位来划分出9种上下行配比方式。

## 频率结构

子载波是LTE系统频率的基本结构单位，为了方便描述，在LTE系统中把时频网格中12个编号连续的子载波组合在一起，构成一个资源块RB，即一个子载波组，规范TS36.211中定义RB的时长是1个时隙0.5ms。在LTE系统中，为每个用户分配时频资源时，以调度块SB为单位，一个调度块的时间范围是一个子帧(传输间隔TTI)，它由两个处在相同频率范围的RB组成，如下图所示。

![SB、RB、RE之间的关系](https://p69.f3.n0.cdn.getcloudapp.com/items/xQuwzm8G/67854253-a138-4a5d-a084-70086e22c22e.png?source=viewer&v=1c88c6d9309d88790d52adc31eba0c4f)

子载波间隔与子载波数量共同决定了频点带宽，同时由于OFDM符号的时长$T_u$等于频率(子载波间隔)的倒数，所以子载波间隔还决定了一个子帧能够包含多少个OFDM符号。LTE系统中定义了6种不同的频点带宽，其中RB、子载波数量与频点带宽之间的关系如下表所示。

|RB数量|100|75|50|25|15|6|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|子载波数量|1200|900|600|300|180|72|
|频点带宽 (MHz)|20|15|10|5|3|1.4|

## 用户时频资源的分配

总结来看，无论是TDD还是FDD方式，对于用户的资源分配都是需要联合考虑时域和频域的，区别是针对于上下行分配频点的方式不同。调度块的分配示意图如下所示。TDD调度块的分配：

![](https://p69.f3.n0.cdn.getcloudapp.com/items/6quzEnKe/f54728c3-2c73-40cb-8ff5-c764681f1ba7.jpg?source=viewer&v=cd882c40ef5f5c43a971232f10d27960)

FDD调度块的分配：

![](https://p69.f3.n0.cdn.getcloudapp.com/items/8Lu0pKm4/aa65f56b-f8d5-4799-94d7-44a038eee9db.jpg?v=0cb8702485ec7232232d9cdb0b049944)

其中，时频调度块SB是分配的基本单位，一个SB占据一个TTI(子帧)的时长(14个OFDM符号)，包含两个RB时长，每个用户可以分配一个或多个SB。TDD模式下，需要按照子帧区分上行和下行分配用户，且上下行共用一个频点，FDD模式下，有两个频点，每个子帧都可以单独调度上下行频谱资源。

## 下行峰值速率的计算方法

给用户分配好SB之后，还需要度量用户传输数据的峰值速率。我们可以使用调度块中每个RE所能承载的数据量来推算，业务数据量的计算公式为：

业务数据量=调度块中业务信道可用RE数量 x 每个RE承载的比特数 x 分配的调度块数量。

接下来，需要研究业务信道中可用的RE数量、每个RE比特数，以及分配的调度块数量取值。

### 1. 业务信道可用的RE数量

业务信道可用的RE数量与下行调度块有关，常见的双天线(端口采用2x2 MIMO工作方式)端口下行调度块时频结构如下图所示：

![](https://p69.f3.n0.cdn.getcloudapp.com/items/RBumyD7y/e6775233-a26c-4962-a170-bb46109f8de2.jpg?v=23b793a2d5636b687db2294319dd027b)

其中每个方格代表一个RE，黑色的RE被小区参考信号所占用，灰色的RE留空不用，留空的RE是为了防止不同的天线之间造成冲突，斜线部分是控制区，控制区的OFDM符号时长范围为1~3，其与频点带宽大小有关，其余白色的部分才可用于业务。因此，在不同控制区的条件下，业务可用的RE数量关系表如下所述。

|控制区占用OFDM符号数量|单天线端口|双天线端口|
|:---:|:---:|:---:|
|1|144|288|
|2|132|264|
|3|120|240|

所以增加了天线的数量相当于是可用的频率资源翻倍(不一定正好是整数倍，因为会引入更多的留空区域)，即空分复用。

### 2. 每个RE上承载的比特数

每个RE上都会承载比特数，承载量与RE的调制方式有关，为了调度方便，在LTE系统中，同一个TTI内，同一个用户的业务数据采用相同的调制方式，而且由于调度块不会在不同用户之间共享，因此一个调度块中用于业务的RE必定采用相同的调制方式。LTE系统下行方向上业务信道可以选择QPSK、16QAM、64QAM这三种调制方式之一，下表列出了在不同调制方式下单个RE可以承载的数据量。

|调制方式|数据量 (bit)|
|:---:|:---:|
|QPSK|2|
|16QAM|4|
|64QAM|6|

### 3. 分配的调度块数量

每个用户在哪个TTI内分配多少个调度块与基站的调度策略相关，调度以TTI为时间单位是动态变化的。用户分配到的SB数量不会超过频点带宽所对应的RB数量，因此可以根据频点带宽确定用户占用调度块数量的上限值，下表列出了不同频点带宽所对应的调度块最大数量。

|频点带宽 (MHz)|调度块最大数量 (个)|
|:---:|:---:|
|5|25|
|10|50|
|15|75|
|20|100|

### 4. 下行峰值速率

一个调度块的周期为1ms，当某用户分配到该频带中全部的调度块数量，控制区最小，且采用64QAM调制方式和2x2 MIMO，和被连续调度时，可以获得下行峰值速率。下表列出了不同频点带宽下用户的峰值速率。

|带宽 (MHz)|1ms承载的最大数据量 (bit)|下行峰值速率 (Mbps)|
|:---:|:---:|:---:|
|5|43200|43.2|
|10|86400|86.4|
|15|129600|129.6|
|20|172800|172.8|

这样求出的峰值速率是毛速率，没有考虑同步信号、广播物理信道的开销，可以根据它们所占的RE进一步计算。另外，由于终端类型和传输块TB的尺寸等因素制约，不同终端在不同的TB条件下，在一个TTI内传输业务的最大比特数有不同的限制，因此精确的峰值速率达不到RE计算出的理论速率。

## 上行峰值速率的计算方法

同理，计算业务数据量的公式仍然不变：业务数据量=调度块中业务信道可用RE数量 x 每个RE承载的比特数 x 分配的调度块数量。只是参数的取值不同。

### 1. 业务可用RE数量

可用的RE数量与上行调度块结构相关，如下图所示，其中阴影部分用于解调参考信号，无底色部分用于业务。

![](https://p69.f3.n0.cdn.getcloudapp.com/items/OAu84yqB/1e5fc2f7-f5d0-4a77-9c69-94383e04a4eb.jpg?v=ac9d2d4c768894c4a0169a0d16489c28)

与下行方向不同，上行方向不支持MIMO，相当于SIMO的情况，另外，上行方向调度块结构固定，业务可用的RE数量固定，一个调度块内有144个可用的RE。

### 2. 每个RE的比特数

不同调制方式下的RE承载比特数能力已在[上表](#每个RE上承载的比特数)中列出，不再赘述。

### 3. 分配的调度块数量

与下行方向不同，上行方向上有些调度块是保留给PUCCH使用的，另外，业务信道可占用的调度块数量必须满足一定的条件，即满足如下公式：

$M_{RB}^{PUSCH}=2^{a_2}\times 3^{a_3}\times 5^{a_5}$

其中，$M_{RB}^{PUSCH}$表示RB的数量，$a_2$, $a_3$, $a_5$为非负数。下表列出了10MHz和20MHz频点带宽所支持的SB上行带宽分配方式。

10MHz频点带宽下，在每个TTI中可分配的SB数量：

|SB数量|子载波数量|
|:---:|:---:|
|1|12|
|2|24|
|3|36|
|4|48|
|5|60|
|6|72|
|8|96|
|9|108|
|10|120|
|12|144|
|15|180|
|16|192|
|18|216|
|20|240|
|24|288|
|25|300|
|27|324|
|30|360|
|32|384|
|36|432|
|40|480|
|45|540|
|48|576|

20MHz频点带宽下，可分配的SB数量：

|SB数量|子载波数量|
|:---:|:---:|
|1|12|
|2|24|
|3|36|
|4|48|
|5|60|
|6|72|
|8|96|
|9|108|
|10|120|
|12|144|
|15|180|
|16|192|
|18|216|
|20|240|
|24|288|
|25|300|
|27|324|
|30|360|
|32|384|
|36|432|
|40|480|
|45|540|
|48|576|
|50|600|
|54|648|
|60|720|
|64|768|
|72|864|
|75|900|
|80|960|
|81|972|
|90|1080|
|96|1152|

一个具体的分配实例是为一个用户上行业务信道分配96个SB；或者为两个用户各分配48各SB；或者为三个用户分别分配45、40、10个SB。因此，不同频点带宽下对应的最大SB数量如下表所示：

|频点带宽 (MHz)|调度块最大数量 (个)|
|:---:|:---:|
|10|48|
|20|96|

### 4. 上行峰值速率

由于目前常见的第3类和第4类终端上行只支持到16QAM，不支持64QAM，因此当终端采用16QAM、用户得到最多SB、且被连续调度时，业务信道可承载最多的数据量，则毛速率如下表所示。

|频点带宽 (MHz)|1ms承载的最大数据量|上行峰值速率 (Mbps)|
|10|27648|27.6|
|20|55296|55.3|

同理，受到终端类型、传输块的制约，精确的峰值速率仍然低于RE计算出的理论速率。
